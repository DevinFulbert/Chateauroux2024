
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../routeur/">
      
      
        <link rel="next" href="../conf/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>NAT - Chateauroux</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#8-nat" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Chateauroux" class="md-header__button md-logo" aria-label="Chateauroux" data-md-component="logo">
      
  <img src="../F5xJkAnWYAAG7eY.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Chateauroux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NAT
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Chateauroux" class="md-nav__button md-logo" aria-label="Chateauroux" data-md-component="logo">
      
  <img src="../F5xJkAnWYAAG7eY.png" alt="logo">

    </a>
    Chateauroux
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Châteauroux IP / VLAN
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Composition du site de Châteauroux
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../shemareseau/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Schéma détaillé du réseau global de Châteauroux
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Définition d'un nom de domaine / SSH
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contrôleur de domaine
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../parefeu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pare-Feu
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../routeur/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Routeur
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    NAT
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    NAT
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration-du-nat" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration du NAT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quest-ce-que-le-nat" class="md-nav__link">
    <span class="md-ellipsis">
      Qu'est ce que le NAT ?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#schema-du-routeur" class="md-nav__link">
    <span class="md-ellipsis">
      Schéma du routeur
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-des-routeurs" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration des Routeurs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration des Routeurs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-des-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration des interfaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-adsl" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration ADSL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-fibre" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Fibre
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capture-de-trafic-reseau-a-dun-port-mirroring" class="md-nav__link">
    <span class="md-ellipsis">
      Capture de trafic réseau à d'un port mirroring
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../conf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Confs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../apache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMZ Privé
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../VPN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VPN
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rp.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverse Proxy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../msg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Messagerie
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../supervision.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supervision
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../WIFI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Borne Wi-FI
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OwnCloud
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration-du-nat" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration du NAT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quest-ce-que-le-nat" class="md-nav__link">
    <span class="md-ellipsis">
      Qu'est ce que le NAT ?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#schema-du-routeur" class="md-nav__link">
    <span class="md-ellipsis">
      Schéma du routeur
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-des-routeurs" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration des Routeurs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration des Routeurs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-des-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration des interfaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-adsl" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration ADSL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-fibre" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Fibre
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capture-de-trafic-reseau-a-dun-port-mirroring" class="md-nav__link">
    <span class="md-ellipsis">
      Capture de trafic réseau à d'un port mirroring
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="8-nat">8/ NAT</h1>
<h2 id="configuration-du-nat"><span style="color: black"> <strong>Configuration du NAT</strong></h2>
<h2 id="quest-ce-que-le-nat"><span style="color: black"> <strong>Qu'est ce que le NAT ?</strong></h2>
<p><strong>NAT (Network Address Translation)</strong> est un processus de <strong>modification des adresses IP</strong> et <strong>des ports source et de destination</strong>. La traduction d'adresses <strong>réduit le besoin d'adresses publiques IPv4 et masque les plages d'adresses réseau privées</strong>. Le processus est généralement effectué par des routeurs ou des pare-feu.</p>
<h2 id="schema-du-routeur"><span style="color: black"> <strong>Schéma du routeur</strong></h2>
<p><img alt="Schéma" src="../img/nat_schema.png" /></p>
<h2 id="configuration-des-routeurs"><span style="color: black"> <strong>Configuration des Routeurs</strong></h2>
<p>Pour la configuration des routeurs on a commencé à faire <strong>la configuration sur le LAN</strong> à l'aide <strong>d'un routeur de notre réseau (172.28.0.0/19)</strong> qui sera par la suite connecté au routeur : <strong>Chateauroux 1</strong> qui a pour adresse <strong>221.87.136.2/30</strong>.</p>
<p>Nous avons commencé par <strong>activer le IP routing</strong> sur le routeur à l'aide de cette commande :</p>
<p><code>conf t</code></p>
<p><code>ip routing</code></p>
<h3 id="configuration-des-interfaces"><span style="color: black"> <strong>Configuration des interfaces</strong></h3>
<p>Par la suite on a configurer les interfaces suivantes :</p>
<p><strong>GigabitEthernet 0/0</strong> et <strong>GigabitEthernet 0/1</strong></p>
<p>Selon le brassage physique que vous faites vous auriez a <strong>définir</strong> si le port 0/0 et le port <strong>outside ou inside</strong> et de même pour le port 0/1.</p>
<p>Dans notre cas nous avons choisis que <strong>le port 0/0</strong> aller être <strong>le port outside</strong> donc connecter avec l'extérieur (internet), et donc <strong>le port 0/1</strong> est donc <strong>le port inside</strong> donc connecter à notre réseau.</p>
<h3 id="configuration-adsl"><span style="color: black"> <strong>Configuration ADSL</strong></h3>
<p><strong>Port GigabitEthernet 0/0 :</strong></p>
<p><code>conf t</code></p>
<p><code>int GigabitEthernet 0/0</code></p>
<p><code>ip address 221.87.136.2 255.255.255.252</code> &lt;-- Correspond à <strong>l'IP du routeur ADSL</strong></p>
<p><code>ip nat outside</code> &lt;-- Réseau <strong>Externe</strong></p>
<p><strong>Port GigabitEthernet 0/1 :</strong></p>
<p><code>conf t</code></p>
<p><code>int GigabitEthernet 0/1</code></p>
<p><code>ip address 172.28.3.253 255.255.255.0</code> &lt;-- <strong>Correspond à la passerelle</strong> pour entrer dans <strong>notre réseau LAN</strong></p>
<p><code>ip nat inside</code> &lt;-- Réseau <strong>Interne</strong></p>
<p>Pour la <strong>traduction d'adresse</strong> :</p>
<p><code>ip nat inside source list 1 interface gigabitEthernet 0/0 overload</code></p>
<p>Puis on a <strong>configurer l'IP route par défaut</strong> :</p>
<p><code>ip route 0.0.0.0 0.0.0.0 221.87.136.1</code></p>
<p><code>access-list 1 permit 172.28.0.0 0.0.31.255</code></p>
<h3 id="configuration-fibre"><span style="color: black"> <strong>Configuration Fibre</strong></h3>
<p><strong>Port GigabitEthernet 0/0 :</strong></p>
<p><code>conf t</code></p>
<p><code>int GigabitEthernet 0/0</code></p>
<p><code>ip address 183.44.36.1 255.255.255.252</code> &lt;-- Correspond à <strong>l'IP du routeur ADSL</strong></p>
<p><code>ip nat outside</code> &lt;-- Réseau <strong>Externe</strong></p>
<p><strong>Port GigabitEthernet 0/1 :</strong></p>
<p><code>conf t</code></p>
<p><code>int GigabitEthernet 0/1</code></p>
<p><code>ip address 172.28.3.253 255.255.255.0</code> &lt;-- <strong>Correspond à la passerelle</strong> pour entrer dans <strong>notre réseau LAN</strong></p>
<p><code>ip nat inside</code> &lt;-- Réseau <strong>Interne</strong></p>
<p>Pour la <strong>traduction d'adresse</strong> :</p>
<p><code>ip nat inside source list 1 interface gigabitEthernet 0/0 overload</code></p>
<p>Puis on a <strong>configurer l'IP route par défaut</strong> :</p>
<p><code>ip route 0.0.0.0 0.0.0.0 183.44.36.2</code></p>
<p><code>access-list 1 permit 172.28.0.0 0.0.31.255</code></p>
<h2 id="capture-de-trafic-reseau-a-dun-port-mirroring"><span style="color: black"> <strong>Capture de trafic réseau à d'un port mirroring</strong></h2>
<p>Le port mirroring est une fonctionnalité de gestion de réseau qui permet de copier le trafic réseau provenant d'un ou plusieurs ports d'un commutateur réseau (ou switch) vers un autre port spécialement configuré à cet effet, appelé "port miroir" ou "port de surveillance." Cette fonctionnalité est couramment utilisée à des fins de dépannage, de surveillance réseau et d'analyse du trafic. </p>
<p>° Pour appliquer le port mirroring sur le <strong>port source</strong> :</p>
<p><code>conf t</code></p>
<p><code>monitor session 1 source interface [nom et numéro de port] both</code></p>
<p>° Pour appliquer le port mirroring sur le <strong>port destination</strong> :</p>
<p><code>conf t</code></p>
<p><code>monitor session 1 destination interface [nom et numéro de port]</code></p>
<p>° Pour vérifier si la fonctionnalité s'est bien appliquée :</p>
<p><code>show monitor session 1</code></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
    
  </body>
</html>